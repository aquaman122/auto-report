{
  "name": "ìŒì„± íšŒì˜ë¡ ì™„ì „ ìë™í™”",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "voice-meeting-upload",
        "options": {
          "rawBody": true
        }
      },
      "name": "ì›¹í›… íŠ¸ë¦¬ê±°",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [240, 300],
      "id": "webhook-trigger"
    },
    {
      "parameters": {
        "functionCode": "// ì—…ë¡œë“œëœ ë°ì´í„° ê²€ì¦ ë° ì •ë¦¬\nconst inputData = $input.first().json;\n\n// íŒŒì¼ ì •ë³´ í™•ì¸\nif (!inputData.audioFile && !inputData.file_path) {\n  throw new Error('ì˜¤ë””ì˜¤ íŒŒì¼ ì •ë³´ê°€ í•„ìš”í•©ë‹ˆë‹¤');\n}\n\n// ë©”íƒ€ë°ì´í„° ì„¤ì •\nconst metadata = {\n  audioFile: inputData.audioFile || inputData.file_path,\n  language: inputData.language || 'ko',\n  userId: inputData.userId || 'system',\n  priority: inputData.priority || 'normal',\n  notify_channels: inputData.notify_channels || ['email'],\n  timestamp: new Date().toISOString(),\n  workflowId: $workflow.id,\n  requestId: $binary.data?.mimeType || Date.now().toString()\n};\n\n// ë¡œê¹…\nconsole.log('ì›Œí¬í”Œë¡œìš° ì‹œì‘:', metadata);\n\nreturn [{ json: metadata }];"
      },
      "name": "ì…ë ¥ ê²€ì¦",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [460, 300],
      "id": "validate-input"
    },
    {
      "parameters": {
        "url": "http://meeting-api:3000/api/audio/upload",
        "options": {
          "bodyContentType": "form-data",
          "timeout": 600000
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "audioFile",
              "value": "={{ $json.audioFile }}"
            },
            {
              "name": "language",
              "value": "={{ $json.language }}"
            },
            {
              "name": "format",
              "value": "all"
            }
          ]
        }
      },
      "name": "ìŒì„± íŒŒì¼ ì²˜ë¦¬",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [680, 300],
      "id": "process-audio"
    },
    {
      "parameters": {
        "functionCode": "// API ì‘ë‹µ ê²€ì¦ ë° ë°ì´í„° í¬ë§·íŒ…\nconst response = $input.first().json;\n\n// ì²˜ë¦¬ ì‹¤íŒ¨ í™•ì¸\nif (!response.success) {\n  const errorMsg = response.message || response.error || 'ìŒì„± ì²˜ë¦¬ ì‹¤íŒ¨';\n  console.error('ìŒì„± ì²˜ë¦¬ ì‹¤íŒ¨:', errorMsg);\n  throw new Error(`ìŒì„± ì²˜ë¦¬ ì‹¤íŒ¨: ${errorMsg}`);\n}\n\n// ì„±ê³µ ë°ì´í„° ì¶”ì¶œ\nconst result = {\n  success: true,\n  \n  // ê¸°ë³¸ ì •ë³´\n  audioFileId: response.data.audio_file_id,\n  meetingId: response.data.meeting_id,\n  processingTime: response.data.processing_time,\n  \n  // íšŒì˜ ë‚´ìš©\n  summary: response.data.summary || 'ìš”ì•½ ì—†ìŒ',\n  actionItems: response.data.action_items || [],\n  participants: response.data.participants || 'ì°¸ì„ì ì—†ìŒ',\n  \n  // ìƒì„±ëœ ë¬¸ì„œë“¤\n  documents: response.documents || {},\n  \n  // URLë“¤\n  urls: response.urls || {},\n  \n  // ì²˜ë¦¬ ì‹œê°„\n  processedAt: new Date().toISOString(),\n  \n  // ì›ë³¸ ë©”íƒ€ë°ì´í„°\n  metadata: $('ì…ë ¥ ê²€ì¦').first().json\n};\n\n// ì•Œë¦¼ìš© ë°ì´í„° ì¤€ë¹„\nresult.notification = {\n  title: 'ğŸ™ï¸ ìŒì„± íšŒì˜ë¡ ìƒì„± ì™„ë£Œ',\n  message: `íšŒì˜ë¡ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\\n\\nğŸ“ ìš”ì•½: ${result.summary.substring(0, 100)}${result.summary.length > 100 ? '...' : ''}\\nğŸ‘¥ ì°¸ì„ì: ${result.participants}\\nâ±ï¸ ì²˜ë¦¬ì‹œê°„: ${result.processingTime}ì´ˆ`,\n  actionItemCount: Array.isArray(result.actionItems) ? result.actionItems.length : 0,\n  hasActionItems: Array.isArray(result.actionItems) && result.actionItems.length > 0\n};\n\nconsole.log('ì²˜ë¦¬ ì™„ë£Œ:', { \n  meetingId: result.meetingId, \n  processingTime: result.processingTime,\n  actionItemCount: result.notification.actionItemCount\n});\n\nreturn [{ json: result }];"
      },
      "name": "ê²°ê³¼ í¬ë§·íŒ…",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [900, 300],
      "id": "format-result"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "leftValue": "={{ $json.notification.hasActionItems }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equal"
              }
            }
          ],
          "combinator": "and"
        }
      },
      "name": "ì•¡ì…˜ì•„ì´í…œ í™•ì¸",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [1120, 200],
      "id": "check-action-items"
    },
    {
      "parameters": {
        "functionCode": "// ì•¡ì…˜ì•„ì´í…œì´ ìˆëŠ” ê²½ìš° íŠ¹ë³„ ì•Œë¦¼ ìƒì„±\nconst data = $input.first().json;\n\nconst urgentNotification = {\n  title: 'ğŸ¯ ê¸´ê¸‰: ì•¡ì…˜ì•„ì´í…œì´ í¬í•¨ëœ íšŒì˜ë¡',\n  message: `ì¤‘ìš”í•œ ì•¡ì…˜ì•„ì´í…œì´ ${data.notification.actionItemCount}ê°œ í¬í•¨ëœ íšŒì˜ë¡ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\\n\\n` + \n           `ğŸ“ íšŒì˜ ìš”ì•½:\\n${data.summary}\\n\\n` +\n           `âœ… ì•¡ì…˜ì•„ì´í…œë“¤:\\n${data.actionItems.slice(0, 3).map(item => `â€¢ ${item.task}${item.assignee ? ' (ë‹´ë‹¹: ' + item.assignee + ')' : ''}`).join('\\n')}` +\n           `${data.actionItems.length > 3 ? '\\n... ë° ' + (data.actionItems.length - 3) + 'ê°œ ë”' : ''}\\n\\n` +\n           `ğŸ“‹ ì¦‰ì‹œ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤!`,\n  priority: 'high',\n  channels: ['email', 'slack'],\n  recipients: ['admin@company.com', 'manager@company.com'],\n  documents: data.documents,\n  meetingId: data.meetingId\n};\n\nreturn [{ json: { ...data, urgentNotification } }];"
      },
      "name": "ê¸´ê¸‰ ì•Œë¦¼ ì¤€ë¹„",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1340, 120],
      "id": "urgent-notification"
    },
    {
      "parameters": {
        "functionCode": "// ì¼ë°˜ ì•Œë¦¼ ìƒì„±\nconst data = $input.first().json;\n\nconst standardNotification = {\n  title: data.notification.title,\n  message: data.notification.message,\n  priority: 'normal',\n  channels: ['email'],\n  recipients: ['team@company.com'],\n  documents: data.documents,\n  meetingId: data.meetingId\n};\n\nreturn [{ json: { ...data, standardNotification } }];"
      },
      "name": "ì¼ë°˜ ì•Œë¦¼ ì¤€ë¹„",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1340, 280],
      "id": "standard-notification"
    },
    {
      "parameters": {
        "url": "http://meeting-api:3000/api/document/generate",
        "options": {
          "bodyContentType": "json"
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "meeting_id",
              "value": "={{ $json.meetingId }}"
            },
            {
              "name": "format",
              "value": "html"
            }
          ]
        }
      },
      "name": "ì¶”ê°€ ë¬¸ì„œ ìƒì„±",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1120, 400],
      "id": "generate-additional-docs"
    },
    {
      "parameters": {
        "functionCode": "// í†µí•© ì•Œë¦¼ ë°œì†¡ ì¤€ë¹„\nconst data = $input.first().json;\nconst notifications = [];\n\n// ê¸´ê¸‰ ì•Œë¦¼ì´ ìˆëŠ” ê²½ìš°\nif (data.urgentNotification) {\n  notifications.push(data.urgentNotification);\n}\n\n// ì¼ë°˜ ì•Œë¦¼ì´ ìˆëŠ” ê²½ìš°  \nif (data.standardNotification) {\n  notifications.push(data.standardNotification);\n}\n\n// ê° ì•Œë¦¼ì„ ê°œë³„ ì¶œë ¥ìœ¼ë¡œ ìƒì„±\nreturn notifications.map(notification => ({ json: notification }));"
      },
      "name": "ì•Œë¦¼ ë°°í¬",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1560, 300],
      "id": "distribute-notifications"
    },
    {
      "parameters": {
        "url": "http://meeting-api:3000/api/meeting/{{ $json.meetingId }}/notify",
        "options": {
          "bodyContentType": "json"
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "notification",
              "value": "={{ $json }}"
            }
          ]
        }
      },
      "name": "ì•Œë¦¼ ë°œì†¡",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1780, 300],
      "id": "send-notifications"
    },
    {
      "parameters": {
        "functionCode": "// ìµœì¢… ì„±ê³µ ë¡œê·¸ ë° ì‘ë‹µ ìƒì„±\nconst data = $input.first().json;\n\nconst finalResult = {\n  success: true,\n  message: 'ìŒì„± íšŒì˜ë¡ ìë™í™” í”„ë¡œì„¸ìŠ¤ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤',\n  \n  // ì²˜ë¦¬ ê²°ê³¼\n  meeting_id: data.meetingId,\n  audio_file_id: data.audioFileId,\n  processing_time_seconds: data.processingTime,\n  \n  // ìƒì„±ëœ ì»¨í…ì¸ \n  summary: data.summary,\n  action_items_count: data.notification.actionItemCount,\n  participants: data.participants,\n  \n  // ë¬¸ì„œ ë§í¬\n  documents: Object.keys(data.documents || {}).map(format => ({\n    format: format,\n    url: data.documents[format].url,\n    filename: data.documents[format].fileName\n  })),\n  \n  // ì²˜ë¦¬ ì‹œê°„\n  started_at: data.metadata.timestamp,\n  completed_at: new Date().toISOString(),\n  \n  // ì•Œë¦¼ ë°œì†¡ ìƒíƒœ\n  notifications_sent: true,\n  notification_channels: data.urgentNotification ? ['email', 'slack'] : ['email']\n};\n\n// ì„±ê³µ ë¡œê·¸\nconsole.log('ğŸ‰ ì›Œí¬í”Œë¡œìš° ì™„ë£Œ:', {\n  meetingId: finalResult.meeting_id,\n  processingTime: finalResult.processing_time_seconds,\n  actionItems: finalResult.action_items_count,\n  documentsGenerated: finalResult.documents.length\n});\n\nreturn [{ json: finalResult }];"
      },
      "name": "ì™„ë£Œ ì²˜ë¦¬",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [2000, 300],
      "id": "completion-handler"
    },
    {
      "parameters": {
        "functionCode": "// ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡œê¹…\nconst error = $input.first().json;\nconst inputData = $('ì…ë ¥ ê²€ì¦').first()?.json || {};\n\n// ì—ëŸ¬ ì •ë³´ ìˆ˜ì§‘\nconst errorInfo = {\n  timestamp: new Date().toISOString(),\n  workflowId: $workflow.id,\n  requestId: inputData.requestId,\n  error: {\n    message: error.message || 'Unknown error',\n    type: error.name || 'WorkflowError',\n    stack: error.stack || null\n  },\n  input: inputData,\n  step: 'unknown' // ì–´ëŠ ë‹¨ê³„ì—ì„œ ì‹¤íŒ¨í–ˆëŠ”ì§€\n};\n\n// ì‹¤íŒ¨ ë‹¨ê³„ ì¶”ì •\nif (error.message?.includes('ìŒì„± ì²˜ë¦¬')) {\n  errorInfo.step = 'audio-processing';\n} else if (error.message?.includes('íŒŒì¼')) {\n  errorInfo.step = 'file-validation';\n} else if (error.message?.includes('ì•Œë¦¼')) {\n  errorInfo.step = 'notification';\n}\n\n// ì—ëŸ¬ ë¡œê¹…\nconsole.error('ğŸš¨ ì›Œí¬í”Œë¡œìš° ì‹¤íŒ¨:', errorInfo);\n\n// ì—ëŸ¬ ì•Œë¦¼ ì¤€ë¹„\nconst errorNotification = {\n  title: 'âŒ ìŒì„± íšŒì˜ë¡ ì²˜ë¦¬ ì‹¤íŒ¨',\n  message: `ìŒì„± íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\\n\\n` +\n           `ğŸ“ íŒŒì¼: ${inputData.audioFile || 'Unknown'}\\n` +\n           `âš ï¸ ì˜¤ë¥˜: ${error.message}\\n` +\n           `ğŸ• ë°œìƒì‹œê°„: ${errorInfo.timestamp}\\n\\n` +\n           `ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.`,\n  priority: 'high',\n  error: errorInfo\n};\n\nreturn [{ json: errorNotification }];"
      },
      "name": "ì—ëŸ¬ ì²˜ë¦¬",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [900, 500],
      "id": "error-handler"
    },
    {
      "parameters": {
        "url": "http://meeting-api:3000/api/system/error-notification",
        "options": {
          "bodyContentType": "json"
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "error_info",
              "value": "={{ $json }}"
            }
          ]
        }
      },
      "name": "ì—ëŸ¬ ì•Œë¦¼ ë°œì†¡",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1120, 500],
      "id": "send-error-notification"
    }
  ],
  "connections": {
    "ì›¹í›… íŠ¸ë¦¬ê±°": {
      "main": [
        [
          {
            "node": "ì…ë ¥ ê²€ì¦",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì…ë ¥ ê²€ì¦": {
      "main": [
        [
          {
            "node": "ìŒì„± íŒŒì¼ ì²˜ë¦¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ìŒì„± íŒŒì¼ ì²˜ë¦¬": {
      "main": [
        [
          {
            "node": "ê²°ê³¼ í¬ë§·íŒ…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ê²°ê³¼ í¬ë§·íŒ…": {
      "main": [
        [
          {
            "node": "ì•¡ì…˜ì•„ì´í…œ í™•ì¸",
            "type": "main",
            "index": 0
          },
          {
            "node": "ì¶”ê°€ ë¬¸ì„œ ìƒì„±",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì•¡ì…˜ì•„ì´í…œ í™•ì¸": {
      "main": [
        [
          {
            "node": "ê¸´ê¸‰ ì•Œë¦¼ ì¤€ë¹„",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ì¼ë°˜ ì•Œë¦¼ ì¤€ë¹„",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ê¸´ê¸‰ ì•Œë¦¼ ì¤€ë¹„": {
      "main": [
        [
          {
            "node": "ì•Œë¦¼ ë°°í¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì¼ë°˜ ì•Œë¦¼ ì¤€ë¹„": {
      "main": [
        [
          {
            "node": "ì•Œë¦¼ ë°°í¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì¶”ê°€ ë¬¸ì„œ ìƒì„±": {
      "main": [
        [
          {
            "node": "ì•Œë¦¼ ë°°í¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì•Œë¦¼ ë°°í¬": {
      "main": [
        [
          {
            "node": "ì•Œë¦¼ ë°œì†¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì•Œë¦¼ ë°œì†¡": {
      "main": [
        [
          {
            "node": "ì™„ë£Œ ì²˜ë¦¬",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "error-handler"
  },
  "staticData": null,
  "tags": ["voice", "meeting", "automation", "ai"],
  "triggerCount": 1,
  "updatedAt": "2024-01-01T00:00:00.000Z",
  "versionId": "1"
}